<div class="container">
    <div class="row">
        <p class="display-1">Reserveringen</p>
    </div>
</div>

<div class="container">


    @defer(when items())
    {
    @if(!loading()){
    <mat-tab-group class="flex-grow-1 mat-elevation-z2">
        <mat-tab label="Beheren">

            <div class="row" style="margin-top:  1em;">
                <mat-label class="col-md-2 col-12" style="margin: 1em; font-size: large;"> Voorstelling/Reservering:
                </mat-label>
                <mat-form-field class="col-md-6 col-12" appearance="outline">
                    <mat-label>Zoeken</mat-label>
                    <input matInput type="text" [ngModel]="searchTerm()"
                        (ngModelChange)="onSearchTermChanged($event)" />
                    <mat-icon matSuffix>search</mat-icon>

                </mat-form-field>
                @if(searching()){
                <mat-progress-bar mode="indeterminate"></mat-progress-bar>
                }
            </div>


            <table class="table ">
                <thead>
                    <tr>
                        <th scope="col">Voorstelling</th>
                        <th scope="col">Voornaam</th>
                        <th scope="col">Achternaam</th>
                        <th scope="col">Email</th>
                        <th scope="col">Datum 1 Aantal</th>
                        <th scope="col">Datum 2 Aantal</th>
                        <th scope="col">Vriend</th>
                        <th scope="col">Lid</th>
                        <th scope="col">Edit</th>
                    </tr>
                </thead>
                <tbody>

                    @for (item of items(); track $index)
                    {
                    <tr>
                        <td>{{item.expand.voorstelling.titel}}</td>
                        <td>{{item.voornaam}}</td>
                        <td>{{item.achternaam}}</td>
                        <td>{{item.email}}</td>
                        <td>{{item.datum_tijd_1_aantal}}</td>
                        <td>{{item.datum_tijd_2_aantal}}</td>


                        <td>
                            <mat-checkbox [checked]="item.is_vriend_van_tovedem" disabled>
                            </mat-checkbox>
                        </td>
                        <td>
                            <mat-checkbox [checked]="item.is_lid_van_vereniging" disabled>
                            </mat-checkbox>
                        </td>
                        @if (!!authService.isGlobalAdmin)
                        {
                        <td>
                            <button mat-fab (click)="openEditDialog(item)">
                                <mat-icon color="">more_vert</mat-icon>
                            </button>
                        </td>
                        }

                        <!--<td> <button mat-icon-button (click)="delete(item)"
                                [disabled]="loading()">
                                <mat-icon color="warn">delete</mat-icon>
                            </button></td>-->
                    </tr>
                    }
                </tbody>
            </table>
        </mat-tab>
        <mat-tab label="Kassa">
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col">Voorstelling</th>
                        <th scope="col">Datum 1 Aantal</th>
                        <th scope="col">Datum 2 Aantal</th>
                        <th scope="col">Achternaam</th>
                        <th scope="col">Vriend</th>
                        <th scope="col">Lid</th>
                    </tr>
                </thead>
                <tbody>
                    @for (item of items(); track $index)
                    {
                    <tr>
                        <td>{{item.expand.voorstelling?.titel}}</td>
                        <td>{{item.datum_tijd_1_aantal}}</td>
                        <td>{{item.datum_tijd_2_aantal}}</td>
                        <td>{{item.achternaam}}</td>

                        <td>
                            <mat-checkbox [checked]="item.is_vriend_van_tovedem" disabled>
                            </mat-checkbox>
                        </td>
                        <td>
                            <mat-checkbox [checked]="item.is_lid_van_vereniging" disabled>
                            </mat-checkbox>
                        </td>

                    </tr>
                    }
                </tbody>
            </table>
        </mat-tab>
        <mat-tab label="Printen">

            <div class="row" style="margin-top:  1em;">
                <mat-label class="col-2" style="margin: 1em; font-size: large;"> Voorstelling:</mat-label>
                <mat-form-field class="col-6">
                    <mat-label>Voorstelling</mat-label>
                    <mat-select [(value)]="selectedVoorstelling" required 
                    (ngModelChange)="onSelectTermChanged($event)" >
                        @for (voorstelling of voorstellingen(); track $index) {
                        <mat-option [value]="voorstelling">{{voorstelling.titel}}</mat-option>
                        }
                           
                    </mat-select>
                </mat-form-field>
                <mat-form-field class="col-3">
                    <mat-label>Datum</mat-label>
                    <mat-select [(value)]="selectedDatum"> 
                        <mat-option>Datum 1</mat-option> 
                        <mat-option>Datum 2</mat-option>
                            
                    </mat-select>
                </mat-form-field>
                <div class="amount-editor" style="align-content: center;">
                    <mat-label class="col-2" style="margin: 1em; font-size: large;"> Aantal kinderplekken:</mat-label>
                    <button mat-mini-fab (click)="decrement()"><mat-icon>remove</mat-icon></button>
                    <mat-form-field class="col-1" appearance="outline" style="margin-inline: 1em; padding-top: 20px;">
                        <input matInput type="number" [ngModel]="kidsLabels"
                            (ngModelChange)="onAmountChange()" /></mat-form-field>
                    <button mat-mini-fab (click)="increment()"><mat-icon>add</mat-icon></button>
                  </div>
                  <div class="col-2">
                    <button mat-fab extended (click)="printen()" color="primary" style="align-self:flex-end">
                        <mat-icon>print</mat-icon>
                        Printen
                    </button></div>
                  
                
                
                <div id="printSection" class="col-12" style="align-items: center;">
                <!--<mat-paginator [length]="200" [pageSizeOptions]="[10, 50, 100]" aria-label="Select page">-->
                    <div class="row">
                        <mat-divider style="margin-top: 3em; margin-bottom: 3em"></mat-divider>
                        <div class="col-3"><img src="/assets/tovedem_logo_klein.png" style="margin-left: 3em; margin-right: 3em; height: 12em;"></div>
                        <div class="col-6" style="align-items: center;">
                            <div class="row" style="text-align: center;"><h2 style="font-weight:200; font-size: 2em"> Gereserveerd voor: </h2></div>
                            <div class="row" style="text-align: center;"><h1 style="font-size: 4em;"> -Klaas Janssen- </h1></div>
                            <div class="row" style="text-align: center;"><h3>""de bende van 4 maal 70"</h3></div>
                            <div class="row" style="text-align: center;"><h3>[20-34-2023]</h3></div>
                        </div>
                        <div class="col-3"><img src="/assets/tovedem_logo_klein.png" style="margin-left: 3em; margin-right: 3em; height: 12em;"></div>
                        <mat-divider style="margin-top: 3em; margin-bottom: 3em"></mat-divider>
                    </div>   
                    
                    <div class="row">
                        <mat-divider style="margin-top: 3em; margin-bottom: 3em"></mat-divider>
                        <div class="col-3"><img src="/assets/tovedem_logo_klein.png" style="margin-left: 3em; margin-right: 3em; height: 12em;"></div>
                        <div class="col-6" style="align-items: center;">
                            <div class="row" style="text-align: center;"><h2 style="font-weight:200; font-size: 2em"> Gereserveerd voor: </h2></div>
                            <div class="row" style="text-align: center;"><h1 style="font-size: 4em;"> -Kinderen- </h1></div>
                            <div class="row" style="text-align: center;"><h3>""de bende van 4 maal 70"</h3></div>
                        </div>
                        <div class="col-3"><img src="/assets/tovedem_logo_klein.png" style="margin-left: 3em; margin-right: 3em; height: 12em;"></div>
                        <mat-divider style="margin-top: 3em; margin-bottom: 3em"></mat-divider>
                    </div> 
                    
                <!--</mat-paginator>-->
                </div>

            </div>

        </mat-tab>
    </mat-tab-group>
    } @else {
    <div class="center">
        <mat-spinner></mat-spinner>
    </div>
    }
    } @placeholder {
    <div class="center">
        <mat-spinner></mat-spinner>
    </div>
    }
</div>