<div class="row">
  <mat-form-field>
    <mat-select
      placeholder="Selecteer een voorstelling"
      (selectionChange)="setSelectedVoorstelling($event)"
    >
      @for (voorstelling of voorstellingen(); track $index) {
        <mat-option [value]="voorstelling"
          >{{ voorstelling.titel }} -
          {{ voorstelling.datum_tijd_1 | date: "dd-MM-YYYY" }}</mat-option
        >
      }
    </mat-select>
  </mat-form-field>

  @if (
    !!selectedVoorstelling() && reserveringenOfSelectedVoorstelling().length > 0
  ) {
    <div class="row col-12 mb-4 justify-content-center">
      <mat-expansion-panel style="width: 80%">
        <mat-expansion-panel-header>
          <mat-panel-title> Toon data tabel </mat-panel-title>
          <mat-panel-description>
            {{ selectedVoorstelling()!.titel }}
          </mat-panel-description>
        </mat-expansion-panel-header>
        <table class="table">
          <thead>
            <tr>
              <th scope="col">Voornaam</th>
              <th scope="col">Achternaam</th>
              <th scope="col">Email</th>
              <th scope="col">Datum 1 Aantal</th>
              <th scope="col">Datum 2 Aantal</th>
              <th scope="col">Vriend</th>
              <th scope="col">Lid</th>
            </tr>
          </thead>
          <tbody>
            @for (item of reserveringenOfSelectedVoorstelling(); track $index) {
              <tr>
                <td>{{ item.voornaam }}</td>
                <td>{{ item.achternaam }}</td>
                <td>{{ item.email }}</td>
                <td>{{ item.datum_tijd_1_aantal }}</td>
                <td>{{ item.datum_tijd_2_aantal }}</td>

                <td>
                  <mat-checkbox [checked]="item.is_vriend_van_tovedem" disabled>
                  </mat-checkbox>
                </td>
                <td>
                  <mat-checkbox [checked]="item.is_lid_van_vereniging" disabled>
                  </mat-checkbox>
                </td>
              </tr>
            }
          </tbody>
        </table>
      </mat-expansion-panel>
    </div>

    <div class="row col-12">
      <div class="col-6">
        <mat-card class="center-items" appearance="outlined">
          <h2>
            {{ selectedVoorstelling()!.datum_tijd_1 | date: "dd-MM-YYYY" }}
          </h2>
          <app-pie-chart
            [series]="seriesDatum1()"
            [labels]="labelsDatum1()"
          ></app-pie-chart>
        </mat-card>
      </div>
      <div class="col-6">
        <mat-card class="center-items" appearance="outlined">
          @if (!!selectedVoorstelling()!.datum_tijd_2) {
            <h2 class="text-center">
              {{ selectedVoorstelling()!.datum_tijd_2! | date: "dd-MM-YYYY" }}
            </h2>
            <app-pie-chart [series]="seriesDatum2()" [labels]="labelsDatum2()">
            </app-pie-chart>
          } @else {
            Geen tweede datum
          }
        </mat-card>
      </div>
    </div>

    <div class="row col-12">
      <mat-form-field class="col-12">
        <mat-label>Zoek naar reservatie</mat-label>
        <input
          type="text"
          aria-label="Number"
          matInput
          [formControl]="reservatieSearchControl"
          [matAutocomplete]="auto"
        />
        <mat-autocomplete
          #auto="matAutocomplete"
          [displayWith]="displayFn"
          (optionSelected)="setSelectedOption($event.option.value)"
        >
          @for (option of filteredOptions | async; track option) {
            <mat-option [value]="option">
              {{ option.voornaam }} - {{ option.achternaam }} -
              {{ option.email }}
            </mat-option>
          }
        </mat-autocomplete>
      </mat-form-field>

      @if (!!selectedOption()) {
        <mat-card>
          <mat-card-header
            >{{ selectedOption()!.voornaam }} {{ selectedOption()!.achternaam }}
          </mat-card-header>
          <mat-card-content>
            {{ selectedOption() | json }}
          </mat-card-content>
        </mat-card>
      }
    </div>
  } @else {
    <div class="row">
      <mat-card class="center-items m-3 p-3" appearance="outlined">
        Geen data beschikbaar
      </mat-card>
    </div>
  }
</div>
